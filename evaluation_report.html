<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bug Fix Evaluation Report</title>
    <style>
        :root {
            --primary: #4a6da7;
            --primary-light: #eef2f9;
            --secondary: #f08c00;
            --text: #333;
            --text-light: #666;
            --background: #f9f9f9;
            --card-bg: #fff;
            --border: #e0e0e0;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--background);
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            margin-bottom: 30px;
            text-align: center;
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .report-meta {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: space-between;
        }
        
        .pr-card {
            flex: 1;
            min-width: 300px;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
        }
        
        .pr-card h3 {
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .pr-card h3 span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .engineer span {
            background-color: var(--primary);
        }
        
        .ai span {
            background-color: var(--secondary);
        }
        
        .pr-meta {
            margin-top: 10px;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .pr-meta p {
            margin: 5px 0;
        }
        
        .score-overview {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .final-score {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
            margin: 20px 0;
        }
        
        .score-label {
            color: var(--text-light);
            margin-bottom: 10px;
        }
        
        .score-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .score-card {
            background-color: var(--primary-light);
            border-radius: 6px;
            padding: 15px;
            width: 180px;
            text-align: center;
        }
        
        .score-card h3 {
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 0.9rem;
            text-transform: uppercase;
        }
        
        .score-card .score {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .score-card .weight {
            font-size: 0.8rem;
            color: var(--text-light);
        }
        
        .details-section {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .section-title {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }
        
        .file-comparison {
            margin-top: 20px;
        }
        
        .file-list {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .file-item {
            padding: 5px 0;
        }
        
        .suggestions {
            margin-top: 20px;
        }
        
        .suggestion-list {
            list-style-type: none;
            margin-top: 10px;
        }
        
        .suggestion-item {
            background-color: var(--primary-light);
            border-left: 3px solid var(--primary);
            padding: 10px 15px;
            margin-bottom: 10px;
            border-radius: 0 4px 4px 0;
        }
        
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .badge-success {
            background-color: var(--success);
            color: white;
        }
        
        .badge-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .badge-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background-color: var(--primary);
            border-radius: 4px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .report-meta {
                flex-direction: column;
            }
            
            .score-cards {
                gap: 10px;
            }
            
            .score-card {
                width: calc(50% - 10px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Bug Fix Evaluation Report</h1>
            <p>Comparing Engineer and AI-generated bug fix implementations</p>
        </header>
        
        <div class="report-meta">
            <div class="pr-card engineer">
                <h3><span></span>Engineer PR</h3>
                <div class="title">Fix null pointer exception in login method</div>
                <div class="pr-meta">
                    <p><strong>Author:</strong> <span id="engineer-author">engineer</span></p>
                    <p><strong>Created:</strong> <span id="engineer-created">May 15, 2023</span></p>
                    <p><strong>Merged:</strong> <span id="engineer-merged">May 16, 2023</span></p>
                </div>
            </div>
            
            <div class="pr-card ai">
                <h3><span></span>AI PR</h3>
                <div class="title">Fix login method null pointer exception</div>
                <div class="pr-meta">
                    <p><strong>Author:</strong> <span id="ai-author">ai-assistant</span></p>
                    <p><strong>Created:</strong> <span id="ai-created">May 15, 2023</span></p>
                    <p><strong>Status:</strong> <span id="ai-status">Open</span></p>
                </div>
            </div>
        </div>
        
        <div class="score-overview">
            <div class="score-label">FINAL SCORE</div>
            <div class="final-score" id="final-score">0.65</div>
            <div class="progress-bar">
                <div class="progress" id="final-score-bar" style="width: 65%"></div>
            </div>
            
            <div class="score-cards">
                <div class="score-card">
                    <h3>Correctness</h3>
                    <div class="score" id="correctness-score">0.70</div>
                    <div class="weight" id="correctness-weight">Weight: 0.35</div>
                    <div class="progress-bar">
                        <div class="progress" id="correctness-bar" style="width: 70%"></div>
                    </div>
                </div>
                
                <div class="score-card">
                    <h3>Readability</h3>
                    <div class="score" id="readability-score">0.85</div>
                    <div class="weight" id="readability-weight">Weight: 0.15</div>
                    <div class="progress-bar">
                        <div class="progress" id="readability-bar" style="width: 85%"></div>
                    </div>
                </div>
                
                <div class="score-card">
                    <h3>Quality</h3>
                    <div class="score" id="quality-score">0.60</div>
                    <div class="weight" id="quality-weight">Weight: 0.15</div>
                    <div class="progress-bar">
                        <div class="progress" id="quality-bar" style="width: 60%"></div>
                    </div>
                </div>
                
                <div class="score-card">
                    <h3>Problem Solving</h3>
                    <div class="score" id="problem-solving-score">0.50</div>
                    <div class="weight" id="problem-solving-weight">Weight: 0.25</div>
                    <div class="progress-bar">
                        <div class="progress" id="problem-solving-bar" style="width: 50%"></div>
                    </div>
                </div>
                
                <div class="score-card">
                    <h3>Similarity</h3>
                    <div class="score" id="similarity-score">0.70</div>
                    <div class="weight" id="similarity-weight">Weight: 0.10</div>
                    <div class="progress-bar">
                        <div class="progress" id="similarity-bar" style="width: 70%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="details-section">
            <h2 class="section-title">Bug Information</h2>
            <p id="bug-description">Fix null pointer exception in login method when user is null, the login method throws NullPointerException</p>
            
            <div class="file-comparison">
                <h3>Modified Files</h3>
                <div>
                    <h4>Common Files:</h4>
                    <ul class="file-list" id="common-files">
                        <li class="file-item">src/main/java/com/example/UserService.java</li>
                    </ul>
                </div>
                <div>
                    <h4>Engineer-only Files:</h4>
                    <ul class="file-list" id="engineer-files"></ul>
                </div>
                <div>
                    <h4>AI-only Files:</h4>
                    <ul class="file-list" id="ai-files"></ul>
                </div>
            </div>
            
            <div class="suggestions">
                <h3>Improvement Suggestions</h3>
                <ul class="suggestion-list" id="suggestions">
                    <li class="suggestion-item">Revisit problem-solving approach to better address the root cause</li>
                    <li class="suggestion-item">Refactor code to improve structure and efficiency</li>
                </ul>
            </div>
        </div>
        
        <footer>
            <p>Generated by Bug Fix Evaluator &copy; 2023</p>
        </footer>
    </div>
    
    <script>
        // This would be replaced with actual data loading from your JSON file
        function loadReportData(reportPath) {
            fetch(reportPath)
                .then(response => response.json())
                .then(data => {
                    renderReport(data);
                })
                .catch(error => {
                    console.error('Error loading report:', error);
                    // If loading fails, use default demo data
                    loadDemoData();
                });
        }
        
        function loadDemoData() {
            // Demo data structure based on your evaluator output
            const demoData = {
                "scores": {
                    "correctness": 0.7,
                    "readability": 0.85,
                    "quality": 0.6,
                    "problem_solving": 0.5,
                    "similarity": 0.7
                },
                "final_score": 0.65,
                "weights": {
                    "correctness": 0.35,
                    "readability": 0.15,
                    "quality": 0.15,
                    "problem_solving": 0.25,
                    "similarity": 0.1
                },
                "details": {
                    "engineer_pr": {
                        "url": "https://github.com/owner/repo/pull/123",
                        "title": "Fix null pointer exception in login method",
                        "author": "engineer",
                        "created_at": "2023-05-15T10:30:45Z",
                        "merged_at": "2023-05-16T14:20:10Z"
                    },
                    "ai_pr": {
                        "url": "https://github.com/owner/repo/pull/456",
                        "title": "Fix login method null pointer exception",
                        "author": "ai-assistant",
                        "created_at": "2023-05-15T09:45:30Z"
                    },
                    "bug_info": {
                        "description": "Fix null pointer exception in login method when user is null, the login method throws NullPointerException",
                        "keywords": ["null", "exception", "login", "method"]
                    },
                    "file_comparison": {
                        "common_files": ["src/main/java/com/example/UserService.java"],
                        "only_engineer_files": [],
                        "only_ai_files": []
                    },
                    "improvement_suggestions": [
                        "Revisit problem-solving approach to better address the root cause",
                        "Refactor code to improve structure and efficiency"
                    ]
                }
            };
            
            renderReport(demoData);
        }
        
        function renderReport(data) {
            // Update PR information
            document.getElementById('engineer-author').textContent = data.details.engineer_pr.author;
            document.getElementById('engineer-created').textContent = formatDate(data.details.engineer_pr.created_at);
            document.getElementById('engineer-merged').textContent = formatDate(data.details.engineer_pr.merged_at);
            
            document.getElementById('ai-author').textContent = data.details.ai_pr.author;
            document.getElementById('ai-created').textContent = formatDate(data.details.ai_pr.created_at);
            document.getElementById('ai-status').textContent = data.details.ai_pr.merged_at ? 'Merged' : 'Open';
            
            // Update bug description
            document.getElementById('bug-description').textContent = data.details.bug_info.description;
            
            // Update scores
            document.getElementById('final-score').textContent = data.final_score.toFixed(2);
            document.getElementById('final-score-bar').style.width = `${data.final_score * 100}%`;
            
            updateScore('correctness', data);
            updateScore('readability', data);
            updateScore('quality', data);
            updateScore('problem-solving', data);
            updateScore('similarity', data);
            
            // Update file lists
            updateFileList('common-files', data.details.file_comparison.common_files);
            updateFileList('engineer-files', data.details.file_comparison.only_engineer_files);
            updateFileList('ai-files', data.details.file_comparison.only_ai_files);
            
            // Update suggestions
            updateSuggestions(data.details.improvement_suggestions);
        }
        
        function updateScore(metricName, data) {
            const dbKey = metricName.replace('-', '_');
            const score = data.scores[dbKey];
            const weight = data.weights[dbKey];
            
            document.getElementById(`${metricName}-score`).textContent = score.toFixed(2);
            document.getElementById(`${metricName}-weight`).textContent = `Weight: ${weight.toFixed(2)}`;
            document.getElementById(`${metricName}-bar`).style.width = `${score * 100}%`;
        }
        
        function updateFileList(elementId, files) {
            const listElement = document.getElementById(elementId);
            listElement.innerHTML = '';
            
            if (files.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'None';
                li.className = 'file-item';
                listElement.appendChild(li);
                return;
            }
            
            files.forEach(file => {
                const li = document.createElement('li');
                li.textContent = file;
                li.className = 'file-item';
                listElement.appendChild(li);
            });
        }
        
        function updateSuggestions(suggestions) {
            const listElement = document.getElementById('suggestions');
            listElement.innerHTML = '';
            
            suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                li.className = 'suggestion-item';
                listElement.appendChild(li);
            });
        }
        
        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }
        
        // Report data embedded directly
const reportData = {
  "scores": {
    "correctness": 0.5,
    "readability": 0.5,
    "quality": 0.5,
    "problem_solving": 0.5,
    "similarity": 0.5
  },
  "final_score": 0.5,
  "weights": {
    "correctness": 0.35,
    "readability": 0.15,
    "quality": 0.15,
    "problem_solving": 0.25,
    "similarity": 0.1
  },
  "details": {
    "engineer_pr": {
      "url": "/var/folders/35/qlqkcnyn295bn3bsfw0kqwjh0000gn/T/tmpk0o17uq5.json",
      "title": "Fix null pointer exception in login method",
      "author": "engineer",
      "created_at": "2023-05-15T10:30:45Z",
      "merged_at": "2023-05-16T14:20:10Z"
    },
    "ai_pr": {
      "url": "/var/folders/35/qlqkcnyn295bn3bsfw0kqwjh0000gn/T/tmpu007vztx.json",
      "title": "Fix login method null pointer exception",
      "author": "ai-assistant",
      "created_at": "2023-05-15T09:45:30Z"
    },
    "bug_info": {
      "description": "Fix null pointer exception in login method When user is null, the login method throws NullPointerException",
      "keywords": [
        "throws",
        "fix",
        "null",
        "user",
        "in",
        "method",
        "null,",
        "nullpointerexception",
        "when",
        "exception"
      ]
    },
    "file_comparison": {
      "common_files": [
        "src/main/java/com/example/UserService.java"
      ],
      "only_engineer_files": [],
      "only_ai_files": []
    },
    "metric_breakdown": {
      "correctness": {
        "score": 0.5,
        "weight": 0.35,
        "details": "Tests pass and bug is fixed correctly"
      },
      "readability": {
        "score": 0.5,
        "weight": 0.15,
        "details": "Code follows style guidelines and is easy to understand"
      },
      "quality": {
        "score": 0.5,
        "weight": 0.15,
        "details": "Code is well-structured, efficient, and adheres to best practices"
      },
      "problem_solving": {
        "score": 0.5,
        "weight": 0.25,
        "details": "The approach effectively addresses the core issue"
      },
      "similarity": {
        "score": 0.5,
        "weight": 0.1,
        "details": "Similarity to the engineer's solution"
      }
    },
    "improvement_suggestions": [
      "Ensure all tests pass and the bug is fully fixed",
      "Improve code readability and adhere to style guidelines",
      "Refactor code to improve structure and efficiency",
      "Revisit problem-solving approach to better address the root cause"
    ]
  }
};
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const reportPath = urlParams.get('report');
            
            renderReport(reportData);
        });
    </script>
</body>
</html> 